# Simon

**S**ales and **I**nventory **M**anagement m**ON**ster

## Description

Simon은 사용자가 판매 및 재고를 관리할 수 있는 판매 및 재고 관리 시스템입니다.

## Usage

### Project setup

```bash
$ pnpm install
```

### Compile and run the project

```bash
# development
$ pnpm run start

# watch mode
$ pnpm run start:dev

# production mode
$ pnpm run start:prod
```

### Run tests

```bash
# unit tests
$ pnpm run test

# e2e tests
$ pnpm run test:e2e

# test coverage
$ pnpm run test:cov
```

## Architecture

Simon은 다음과 같은 기술을 사용하여 구현되어 있습니다.

- **NestJS**: Node.js 프레임워크로 Simon의 서버를 구현합니다.
- **TypeORM**: TypeScript ORM으로 Simon의 데이터베이스를 구현합니다.
- **PostgreSQL**: Simon의 데이터베이스로 사용합니다.

## Domain

Simon은 다음과 같은 도메인을 가지고 있습니다.

### Product(제품)

제품은 사용자가 판매할 수 있는 상품이다.

제품은 카테고리로 분류할 수 있다. 카테고리는 제품을 분류하는 기준이다. 하나의 제품은 여러 카테고리에 속할 수 있다. 카테고리는 상위 카테고리를 가질 수 있다.

제품은 생산자 혹은 판매자로부터 구매할 수 있다.

제품은 다음과 같은 정보를 가진다.

- 코드
- 이름
- 가격
- 카테고리
- 상세설명
- 생산자/공급자
- 회수 여부
- 적정재고
- 안전재고

### Staff(직원)

직원은 Simon을 사용하는 사용자이다. 직원은 권한에 따라 Simon의 기능을 사용할 수 있다. 직원은 전화번호를 통해 식별할 수 있다.

직원은 다음과 같은 권한을 가질 수 있다.

- 관리자
- 판매자
- 재고관리자
- 배송담당자

직원은 다음과 같은 정보를 가진다.

- 이름
- 전화번호
- 권한
- 생년월일
- 주소

### Sale(판매)

판매는 사용자가 제품을 판매하는 행위이다. 판매에는 견적서와 영수증이 있다.

견적서는 판매를 예약하는 문서이다. 영수증은 판매를 완료하는 문서이다.

여러 견적서를 하나의 영수증으로 묶어 판매를 완료할 수 있다.

판매 도메인과 관련된 요구사항은 다음과 같다.

- 최소 한 개 이상의 제품을 판매해야 한다.
- 한 제품을 한 개 이상 주문할 수 있다.
- 총 판매 금액은 각 제품의 가격과 수량을 곱한 값의 합이다.
- 견적에서 판매로 전환되면 판매가능 수량을 감소시킨다.
- 제품이 출고되면 재고를 감소시킨다.
- 제품은 판매가능 수량 이상으로 판매할 수 없다.
- 판매가 완료되기 전에 취소할 수 있다.
- 판매가 완료되기 전에 제품을 추가, 수정, 삭제할 수 있다.
- 판매 완료 과정에서 결제를 진행할 수 있고, 결제를 하지 않고 판매를 완료하면 미수금이 발생한다.
- 배송지는 기본적으로 고객의 주소를 따르지만 별도로 지정할 수 있다.

### Estimate(견적)

견적은 고객이 가격을 확인하는 문서이다.

견적은 판매로 전환될 수 있으며, 판매로 전환되면 견적은 영수증으로 변환된다.

견적은 다음과 같은 정보를 가진다.

- 견적번호
- 견적 상품
  - 제품명
  - 수량
  - 가격
- 견적 관련 정보(예: 차량 번호, 차대번호, 차종 등)
- 견적일
- 유효기간
- 총 금액
- 고객
- 판매자
- 고객 요청사항

### Receipt(영수증)

영수증은 고객의 주문을 확인하는 문서이다.

영수증은 판매로부터 생성되며, 견적으로부터 생성될 수 있다.

영수증은 다음과 같은 정보를 가진다.

- 영수증번호
- 판매 상품
  - 제품명
  - 수량
  - 가격
- 판매일
- 총 금액
- 고객
- 배송정보
  - 배송지
  - 배송상태
  - 배송자
- 판매자

### Inventory(재고)

재고는 사용자가 보유하고 있는 제품의 수량이다. 위치는 제품이 보관되는 장소이다.

재고는 발주에 의해 증가하거나 판매에 의해 감소할 수 있다.

재고는 다음과 같은 정보를 가진다.

- 제품
- 수량
- 위치
- 재고조사일
- 재고조사자

재고 도메인과 관련된 요구사항은 다음과 같다.

- 재고를 임의로 변경할 때 이유를 입력해야한다.
- 재고가 안전재고보다 적으면 재고 부족 알림을 발생시킨다.
- 동일한 제품을 동일한 위치에 중복해서 추가할 수 없다.
- 하나의 제품을 여러 위치에 추가할 수 있다.
- 재고를 추가할 때 제품의 적정재고를 초과할 수 있다.
- 재고는 출고될 때 감소한다.
- 재고수량은 0보다 작을 수 없다.

### Order(발주)

발주는 사용자가 제품을 구매하는 행위이다.

발주는 다음과 같은 정보를 가진다.

- 제품
  - 발주수량
  - 도착수량
  - 가격
- 발주상태
- 발주일
- 도착예정일
- 총 금액
- 발주자
- 공급자

발주 상태는 다음과 같다.

- 발주 대기
- 발주 완료
- 입고 대기
- 입고 완료

발주 도메인과 관련된 요구사항은 다음과 같다.

- 최소 한 개 이상의 제품을 발주해야 한다.
- 한 제품을 한 개 이상 주문할 수 있다.
- 발주가 완료되면 제품을 입고할 수 있다.
- 발주시에 도착예정일을 지정할 수 있다.
- 발주가 완료되기 전에 추가, 수정, 취소할 수 있다.
- 발주를 완료할 때 도착수량 및 가격을 입력할 수 있다.
- 발주가 완료되면 발주 상태를 변경한다.
- 발주가 완료되면 발주 금액을 계산한다.
- 발주가 완료되면 미지급금이 발생한다.

### Receive(입고)

입고는 사용자가 제품을 재고에 추가하는 행위이다.

발주서를 바탕으로 도착 수량을 입력하여 제품을 재고에 추가할 수 있다.

입고 도메인과 관련된 요구사항은 다음과 같다.

- 입고가 완료되면 제품의 재고를 증가시킨다.

### Delivery(배송)

배송은 사용자가 제품을 판매하는 고객에게 전달하는 행위이다.

배송은 판매에 의해 발생하며, 배송이 완료되면 판매가 완료된다.

배송은 다음과 같은 상태를 가진다.

- 배송 준비
- 배송 중
- 배송 완료

### Party(거래처)

거래처는 사용자와 거래하는 판매자 혹은 구매자이다.

거래처는 다음과 같은 정보를 가진다.

- 코드
- 이름
- 별칭
- 전화번호
- 주소
- 이메일
- 사업자번호
- 업종
- 거래처 그룹
- 거래처 종류

거래처 도메인과 관련된 요구사항은 다음과 같다.

- 거래처는 판매자 혹은 구매자 혹은 둘 다일 수 있다.
- 거래처는 개인 혹은 업체일 수 있다.
- 거래처는 여러 거래처 그룹에 속할 수 있다.
- 업체는 사업자번호를 가져야 한다.
- 개인은 업체의 직원으로 등록될 수 있다.

### Recovery(회수)

회수는 고객으로부터 사용된 제품을 회수하는 행위이다.

회수는 다음과 같은 상태를 가진다.

- 회수 대기
- 회수 완료
- 분실
- 대금 지급

회수 도메인과 관련된 요구사항은 다음과 같다.

- 회수대상 제품이 판매가 완료되면 회수 리스트에 추가된다.
- 회수가 완료되면 회수 일자를 기록하고 회수 상태를 변경한다.

### Payment(결제)

결제는 사용자가 판매를 완료할 때 발생하는 결제 행위이다.

결제는 다음과 같은 방법으로 이루어질 수 있다.

- 현금
- 카드
- 계좌이체
- 기타(지역상품권, 포인트, 쿠폰 등)

결제는 다음과 같은 정보를 가진다.

- 결제일
- 결제금액
- 결제수단
- 담당자

결제 도메인과 관련된 요구사항은 다음과 같다.

- 결제가 완료되고 결제금액이 미수금보다 적으면 미수금을 감소시킨다.
- 미수금이 0미만이면 선수금을 증가시킨다.
- 결제금액이 미수금보다 많으면 차액을 선수금으로 처리한다.

### Account Balance(계정 잔액)

계정 잔액은 거래처의 선수금, 미수금, 선급금, 미지급금을 나타내는 도메인이다.

계정 잔액은 다음과 같은 정보를 가진다.

- 거래처
- 잔액
- 최종 변경일
- 잔액 유형
- 상태

잔액 유형은 다음과 같다.

- 선수금: 거래처로부터 미리 받은 금액
- 미수금: 거래처에게 받지 못한 금액
- 선급금: 거래처에게 미리 지불한 금액
- 미지급금: 거래처에게 지불해야 할 금액

계정 잔액 도메인과 관련된 요구사항은 다음과 같다.

- 거래처는 선수금, 미수금, 선급금, 미지급금 중 하나 이상을 가질 수 있다.
- 거래처의 잔액은 거래처의 판매, 회수, 결제, 발주, 입고 등에 따라 변경된다.
- 거래처의 잔액이 일정 금액을 초과하면 잔액 초과 알림을 발생시킨다.

### Notification(알림)

알림은 사용자에게 Simon의 상태를 알리는 메시지이다.

알림은 다음과 같은 이벤트에 의해 발생한다.

- 재고 부족
- 미수금 초과

### Audit(감사)

감사는 Simon의 사용 기록을 기록하는 행위이다.

감사는 다음과 같은 이벤트를 기록한다.

- 로그인
- 로그아웃
- 판매
- 발주
- 입고
- 배송
- 회수
- 결제
